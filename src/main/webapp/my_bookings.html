<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Bookings</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --brand:#0b7285;
      --brand2:#1098ad;
      --ok:#16a34a;
      --warn:#f59e0b;
      --bad:#ef4444;
      --muted:#6b7280;
      --bg:#f4f6fb;
      --card:#ffffff;
      --line:#e5e7eb;
      --shadow:0 8px 24px rgba(15,23,42,.08);
      --radius:16px;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial;
      background:var(--bg);color:#0f172a;
    }
    header{
      position:sticky;top:0;z-index:10;background:#fff;
      border-bottom:1px solid var(--line);
    }
    .topbar{
      max-width:960px;margin:0 auto;
      padding:14px 16px;
      display:flex;align-items:center;justify-content:space-between;
    }
    .title{font-weight:700;font-size:1.05rem}
    .tabs{
      max-width:960px;margin:0 auto;
      display:flex;gap:8px;padding:8px 16px;overflow-x:auto;
    }
    .tab{
      border:1px solid var(--line);background:#fff;
      padding:7px 14px;border-radius:999px;
      font-size:.9rem;cursor:pointer;white-space:nowrap;
    }
    .tab.active{background:var(--brand);border-color:transparent;color:#fff}

    main{max-width:960px;margin:16px auto 96px;padding:0 16px;}

    /* timeline */
    .timeline{
      background:#fff;border-radius:var(--radius);
      border:1px solid var(--line);
      padding:10px;display:flex;gap:8px;overflow-x:auto;
      box-shadow:var(--shadow);
    }
    .chip{
      border:1px solid var(--line);border-radius:999px;
      padding:7px 12px;background:#fff;
      font-size:.9rem;white-space:nowrap;cursor:pointer;
    }
    .chip.active{background:var(--brand2);color:#fff;border-color:transparent}

    /* cards */
    .cards{margin-top:14px;}
    .card{
      background:var(--card);border-radius:var(--radius);
      border:1px solid var(--line);
      padding:14px 14px 10px;margin-bottom:12px;
      box-shadow:var(--shadow);cursor:pointer;
      transition:box-shadow .15s,transform .15s;
    }
    .card:hover{box-shadow:0 12px 32px rgba(15,23,42,.12);transform:translateY(-1px);}
    .card-header{
      display:flex;gap:12px;align-items:center;flex-wrap:wrap;
    }
    .thumb{
      width:64px;height:64px;border-radius:14px;
      background:linear-gradient(135deg,#cfe9ff,#ecf5ff);
      display:grid;place-items:center;
      font-weight:700;color:var(--brand2);font-size:.8rem;flex:0 0 64px;
    }
    .meta{flex:1 1 auto;min-width:200px;}
    .route{font-weight:700;margin-bottom:2px;}
    .time{color:var(--muted);font-size:.9rem;}
    .status{
      padding:5px 10px;border-radius:999px;font-size:.8rem;
      font-weight:600;white-space:nowrap;
    }
    .status.confirmed{background:#ecfdf5;color:var(--ok);}
    .status.canceled{background:#fef2f2;color:var(--bad);}
    .status.pending{background:#fffbeb;color:var(--warn);}

    .toggle-label{
      margin-left:auto;font-size:.85rem;color:var(--brand2);
    }

    .collapsible{
      margin-top:10px;border-top:1px dashed var(--line);
      padding-top:10px;display:none;
    }
    .card.open .collapsible{display:block;}

    .grid2{
      display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:12px;margin-bottom:10px;
    }
    .box{
      border-radius:12px;border:1px dashed var(--line);
      background:#f9fafb;padding:10px;
      font-size:.9rem;
    }
    .box strong{display:block;margin-bottom:4px;}
    table{width:100%;border-collapse:collapse;font-size:.9rem;margin-top:4px;}
    th,td{padding:6px 4px;border-bottom:1px solid var(--line);text-align:left;}
    th{font-weight:600;color:#4b5563;}
    tfoot td{border-bottom:none;}

    .actions{
      display:flex;gap:8px;justify-content:flex-end;flex-wrap:wrap;margin-top:6px;
    }
    .btn{
      border-radius:10px;border:1px solid var(--line);
      padding:7px 14px;font-size:.85rem;cursor:pointer;
      background:#fff;
    }
    .btn.secondary{color:var(--brand2);border-color:var(--brand2);}
    .btn.primary{background:var(--brand2);border-color:var(--brand2);color:#fff;}

    /* bottom nav (اختياري تربطينه مع باقي الصفحات) */
    .nav{
      position:fixed;bottom:0;left:0;right:0;
      background:#fff;border-top:1px solid var(--line);
      display:grid;grid-template-columns:repeat(4,1fr);gap:6px;
      padding:8px 10px;
    }
    .nav a{
      text-decoration:none;font-size:.8rem;text-align:center;
      border-radius:12px;border:1px solid var(--line);
      padding:6px;color:#374151;background:#fff;
    }
    .nav a.active{background:var(--brand);color:#fff;border-color:transparent;}
  </style>
</head>
<body>

<header>
  <div class="topbar">
    <div class="title">My Bookings</div>
  </div>
  <div class="tabs" role="tablist">
    <button class="tab active" data-scope="upcoming">Upcoming</button>
    <button class="tab" data-scope="past">Past</button>
  </div>
</header>

<main>
  <!-- Timeline -->
  <div class="timeline">
    <button class="chip active" data-range="today">Today</button>
    <button class="chip" data-range="tomorrow">Tomorrow</button>
    <button class="chip" data-range="week">Next 7 Days</button>
    <button class="chip" data-range="month">This Month</button>
  </div>

  <!-- Cards -->
  <section class="cards" id="cards"></section>
</main>

<!-- Bottom nav (عدلي الروابط لأسماء ملفاتك) -->
<nav class="nav">
  <a href="index_en.html">Home</a>
  <a href="search_en.html">Search</a>
  <a href="#" class="active">Tickets</a>
  <a href="support_en.html">Support</a>
</nav>

<script>
  // Dummy data – later يمكن تربطيه بقاعدة بيانات أو سيرفلت
  const BOOKINGS = [
    {
      id:"SAR-94821",
      scope:"upcoming",
      date:"2025-11-14",
      status:"confirmed",
      from:"Riyadh",
      to:"Qurayyat",
      dep:"08:10", arr:"13:55",
      coach:"2", seat:"14A", price:"SAR 180.00"
    },
    {
      id:"SAR-94213",
      scope:"upcoming",
      date:"2025-11-15",
      status:"pending",
      from:"Makkah (Haramain)",
      to:"Madinah",
      dep:"16:20", arr:"18:50",
      coach:"5", seat:"08C", price:"SAR 130.00"
    },
    {
      id:"SAR-90577",
      scope:"past",
      date:"2025-10-20",
      status:"canceled",
      from:"Riyadh",
      to:"Dammam",
      dep:"09:30", arr:"12:05",
      coach:"1", seat:"02D", price:"SAR 95.00"
    }
  ];

  let currentScope = "upcoming";
  let currentRange = "week"; // افتراضي: الأسبوع القادم

  const cardsEl = document.getElementById("cards");
  const tabs = document.querySelectorAll(".tab");
  const chips = document.querySelectorAll(".chip");

  function statusClass(st){
    if(st==="confirmed") return "confirmed";
    if(st==="canceled") return "canceled";
    return "pending";
  }

  function dateInRange(iso, range){
    const d = new Date(iso);
    const today = new Date();
    today.setHours(0,0,0,0);
    const diff = Math.floor((d - today)/86400000); // days
    if(range==="today") return diff===0;
    if(range==="tomorrow") return diff===1;
    if(range==="week") return diff>=0 && diff<=7;
    if(range==="month")
      return d.getFullYear()===today.getFullYear() &&
             d.getMonth()===today.getMonth();
    return true;
  }

  function render(){
    cardsEl.innerHTML = "";
    const filtered = BOOKINGS.filter(b =>
      b.scope===currentScope && dateInRange(b.date,currentRange)
    );
    if(filtered.length===0){
      cardsEl.innerHTML =
        '<p style="margin-top:14px;color:#6b7280;">No bookings in this range.</p>';
      return;
    }
    filtered.forEach(b => cardsEl.appendChild(makeCard(b)));
  }

  function makeCard(b){
    const card = document.createElement("article");
    card.className = "card";
    card.innerHTML = `
      <div class="card-header">
        <div class="thumb">
          <div>TRAIN</div>
        </div>
        <div class="meta">
          <div class="route">${b.from} → ${b.to}</div>
          <div class="time">${b.date} • ${b.dep} – ${b.arr} • ${b.id}</div>
        </div>
        <span class="status ${statusClass(b.status)}">
          ${b.status.charAt(0).toUpperCase()+b.status.slice(1)}
        </span>
        <span class="toggle-label">View details</span>
      </div>
      <div class="collapsible" aria-hidden="true">
        <div class="grid2">
          <div class="box">
            <strong>Trip schedule</strong>
            <table>
              <thead>
                <tr><th>Leg</th><th>Station</th><th>Time</th></tr>
              </thead>
              <tbody>
                <tr><td>Departure</td><td>${b.from}</td><td>${b.dep}</td></tr>
                <tr><td>Arrival</td><td>${b.to}</td><td>${b.arr}</td></tr>
              </tbody>
            </table>
          </div>
          <div class="box">
            <strong>Ticket details</strong>
            <table>
              <tbody>
                <tr><td>Booking No.</td><td>${b.id}</td></tr>
                <tr><td>Coach / Seat</td><td>${b.coach} / ${b.seat}</td></tr>
                <tr><td>Price</td><td>${b.price}</td></tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="actions">
          <button class="btn secondary" data-reschedule>Reschedule</button>
          <button class="btn primary" data-download>Download Ticket</button>
        </div>
      </div>
    `;

    const header = card.querySelector(".card-header");
    const coll = card.querySelector(".collapsible");
    const label = card.querySelector(".toggle-label");

    header.addEventListener("click", () => {
      const open = card.classList.toggle("open");
      coll.setAttribute("aria-hidden", String(!open));
      label.textContent = open ? "Hide details" : "View details";
    });

    card.querySelector("[data-reschedule]").addEventListener("click", (e)=>{
      e.stopPropagation();
      alert("Reschedule flow for " + b.id);
    });
    card.querySelector("[data-download]").addEventListener("click", (e)=>{
      e.stopPropagation();
      alert("Downloading ticket for " + b.id);
    });

    return card;
  }

  // tabs (upcoming / past)
  tabs.forEach(t=>{
    t.addEventListener("click", ()=>{
      tabs.forEach(x=>x.classList.remove("active"));
      t.classList.add("active");
      currentScope = t.dataset.scope;
      render();
    });
  });

  // timeline chips
  chips.forEach(c=>{
    c.addEventListener("click", ()=>{
      chips.forEach(x=>x.classList.remove("active"));
      c.classList.add("active");
      currentRange = c.dataset.range;
      render();
    });
  });

  // default: week
  document.querySelector(".chip.active").classList.remove("active");
  document.querySelector('[data-range="week"]').classList.add("active");
  currentRange = "week";
  render();
</script>
</body>
</html>
